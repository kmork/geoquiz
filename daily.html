<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Daily Challenge - GeoQuiz</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <meta name="description" content="Take the daily geography challenge! Test your knowledge with 6 mini-games and share your score.">


  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="css/daily-challenge.css">
</head>
<body>
  <header>
    <nav>
      <a href="index.html" class="logo">ğŸŒ GeoQuiz</a>
    </nav>
  </header>

  <main class="daily-landing">
    <div class="daily-hero">
      <div class="daily-icon">ğŸ“…</div>
      <h1>Daily Challenge</h1>
      <p class="daily-subtitle">6 games â€¢ One chance â€¢ Share your score!</p>
    </div>

    <div class="daily-challenge-card" id="challenge-card">
      <!-- Will be populated by JavaScript -->
    </div>

    <div class="daily-stats-card" id="stats-card">
      <h2>ğŸ“Š Your Statistics</h2>
      <div class="stats-grid">
        <div class="stat-item">
          <div class="stat-value" id="current-streak">0</div>
          <div class="stat-label">ğŸ”¥ Current Streak</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="max-streak">0</div>
          <div class="stat-label">ğŸ† Best Streak</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="total-completed">0</div>
          <div class="stat-label">âœ… Completed</div>
        </div>
        <div class="stat-item">
          <div class="stat-value" id="average-stars">0.0</div>
          <div class="stat-label">â­ Avg Stars</div>
        </div>
      </div>
    </div>

    <div class="daily-info">
      <h3>How It Works</h3>
      <ul>
        <li>ğŸ¯ Play 6 geography mini-games</li>
        <li>âš¡ The faster you answer, the more stars you earn</li>
        <li>â­ Earn up to 23 stars total</li>
        <li>ğŸ”¥ Build your daily streak!</li>
        <li>ğŸ“± Share your score and compete with friends</li>
      </ul>
    </div>
  </main>

  <script src="js/theme.js"></script>
  <script type="module">
    import { getTodayDate, getChallengeNumber } from './js/seeded-random.js';
    import { hasCompletedToday, getResultForDate, getStats, getTimeUntilNext } from './js/daily-challenge-scoring.js';

    const today = getTodayDate();
    const challengeNum = getChallengeNumber(today);
    const hasPlayed = hasCompletedToday(today);
    const result = getResultForDate(today);
    const stats = getStats();

    // Populate challenge card
    const challengeCard = document.getElementById('challenge-card');

    if (hasPlayed && result) {
      // Already completed today - show results
      const { hours, minutes } = getTimeUntilNext();
      challengeCard.innerHTML = `
        <div class="challenge-completed">
          <div class="completed-icon">âœ…</div>
          <h2>Challenge #${challengeNum} Complete!</h2>
          <div class="completed-score">
            <div class="score-stars">â­ ${result.stars}/23 stars</div>
            <div class="score-time">â±ï¸ ${Math.floor(result.totalTime / 60)}:${(result.totalTime % 60).toString().padStart(2, '0')}</div>
          </div>
          <p class="next-challenge">Next challenge in ${hours}h ${minutes}m</p>
          <a href="daily-challenge.html?review=${today}" class="btn btn-secondary">
            ğŸ“Š Review Results
          </a>
        </div>
      `;
    } else {
      // Not played yet - show start button
      const dateFormatted = new Date(today + 'T00:00:00').toLocaleDateString('en-US', {
        month: 'long',
        day: 'numeric',
        year: 'numeric'
      });

      challengeCard.innerHTML = `
        <div class="challenge-available">
          <h2>Challenge #${challengeNum}</h2>
          <p class="challenge-date">${dateFormatted}</p>
          <a href="daily-challenge.html" class="btn-start-challenge">
            ğŸ® Start Today's Challenge
          </a>
        </div>
      `;
    }

    // Populate stats
    document.getElementById('current-streak').textContent = stats.currentStreak || 0;
    document.getElementById('max-streak').textContent = stats.maxStreak || 0;
    document.getElementById('total-completed').textContent = stats.totalCompleted || 0;
    document.getElementById('average-stars').textContent = stats.averageStars || '0.0';
  </script>
</body>
</html>
